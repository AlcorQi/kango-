## 性能考虑：
**纯关键字模式：性能最好，适合大规模日志扫描**
**纯正则表达式模式：最精确，但性能开销较大**
**混合模式：平衡性能和准确性，推荐使用**

## 建议根据实际需求选择合适的检测模式。对于生产环境，混合模式通常是最佳选择。

## 使用说明

### 三种检测模式的使用方式：

1. **纯关键字模式** (`--detection-mode keyword`)
   - 使用原有的简单关键字匹配
   - 性能最好，但可能产生误报

2. **纯正则表达式模式** (`--detection-mode regex`)  
   - 使用正则表达式进行精确匹配
   - 准确性最高，但性能略低

3. **混合模式** (`--detection-mode mixed`)
   - 同时使用关键字和正则表达式
   - 平衡了性能和准确性（推荐）

### 命令行示例：
```bash
# 使用混合模式（推荐）
python main.py --detection-mode mixed

# 使用纯正则表达式模式
python main.py --detection-mode regex

# 使用纯关键字模式
python main.py --detection-mode keyword

注意：在正则表达式中，我们使用.*?来匹配任意字符（非贪婪），\s匹配空白字符，\d匹配数字，[0-9a-fA-F]匹配十六进制数字。

## 主要改进点：

1. **真正处理分隔关键词**：使用 `.*?` 非贪婪匹配允许关键词之间插入任意内容
2. **基于内在规律**：匹配错误模式而非固定文本，如地址模式、数字模式、代码模式等
3. **处理变体表达**：使用分组匹配同一概念的不同表达方式
4. **更灵活的匹配**：能够匹配各种非标准格式的日志条目

现在这些正则表达式能够真正处理：
- "Out - of - memory: kill process 1234"（分隔关键词）
- "OOM killer invoked with gfp_mask=0x201da"（内在规律）
- "Call Trace for potential deadlock"（变体表达）
- "file system corruption detected in superblock"（复杂模式）

这样的设计使得正则表达式检测模式真正发挥优势，能够检测到纯关键字模式会漏掉的许多异常情况。

现在当你使用`--detection-mode regex`时，会看到真正的正则表达式优势：更精确的匹配、更好的上下文理解、更少的误报。你可以通过比较三种模式的结果来验证改进效果。